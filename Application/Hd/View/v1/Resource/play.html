<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="page-view-size" content="1280*720">
        <title></title>
        <script type="text/javascript" src="__COMMON__/js/base.js?__CSSJS_VERSION__"></script>
        <script type="text/javascript" src="__COMMON__/js/play/play{$areacode}.js?__CSSJS_VERSION__"></script>
        <style type="text/css">
            body{ 
                background:transparent;
            }

            #div_control{
                position:absolute;
                width:332px;
                height:85px;
                top:550px;
                left:474px;
                visibility:hidden;
                background-image: url(__HD__/images/play/handle_bg.png);
            }

            #div_top{
                position:absolute;
                width:290px;
                height:56px;
                top:60px;
                left:100px;
                visibility:visible;
                background-image: url(__HD__/images/play/exercise_bg.png);            
            }

        </style>

        <script type="text/javascript">
            var buttons =
                    [
                        /*左边按钮*/
                        {id: 'btn_pre', name: '', action: 'prevPlay()', linkImage: '__HD__/images/play/btn_pre.png', focusImage: '__HD__/images/play/btn_pre_over.png', selectBox: '', left: '', right: 'btn_current', up: 'btn_exercise', down: ''},
                        {id: 'btn_current', name: '', action: '', linkImage: '__HD__/images/play/btn_current.png', focusImage: '__HD__/images/play/btn_current_over.png', selectBox: '', left: 'btn_pre', right: 'btn_next', up: 'btn_exercise', down: ''},
                        {id: 'btn_next', name: '', action: 'nextPlay()', linkImage: '__HD__/images/play/btn_next.png', focusImage: '__HD__/images/play/btn_next_over.png', selectBox: '', left: 'btn_current', right: '', up: 'btn_exercise', down: ''},
                        /*上边按钮*/
                        {id: 'btn_exercise', name: '', action: '', linkImage: '__HD__/images/play/btn_exercise.png', focusImage: '__HD__/images/play/btn_exercise_over.png', selectBox: '', left: '', right: '', up: '', down: 'btn_current'},
                    ];

            //视频销毁
            function destory() {
                destoryMP();
            }

            /**
             * 显示播放控件
             */
            function showMenu(show)
            {
            	if(show){
            		G('div_control').style.visibility = 'visible';
                    Epg.Button.set('btn_current');
            	}else{
            		G('div_control').style.visibility = 'hidden';
                    Epg.Button.set('btn_exercise');
            	}
            }
            
            var videoContent = 'rtsp://192.168.0.5:8554/videos/prog00000002a9417711000008654004.ts';//'{$playData[content]}';
            var prevUrl = '{$playData[prevUrl]}';
            var nextUrl = '{$playData[nextUrl]}';
            var libUrl = '{$playData[libUrl]}';
            var backUrl = "{:get_back_url('Index/recommend',1)}";
            var timer = '';
            var initPlay = function() {
                play(videoContent, 1280, 720, 0, 0);
            }
            var curPlayTime;
            var totalPlayTime;
            //自动播放
            var autoPlay = function() {
                curPlayTime = getCurrentTime();//获取当前播放时间
                //totalPlayTime = getTotalTime();
                totalPlayTime = 1000;
                if ((curPlayTime >= totalPlayTime) && (curPlayTime != 0) && (totalPlayTime != 0)) {
                    if(libUrl){
                        window.location = libUrl;
                    }else if (nextUrl) {
                        window.location = nextUrl;
                    } else {
                        destory();
                        window.location = backUrl;
                    }
                }
            }

            var timeAutoPlay;
            timeAutoPlay = setInterval("autoPlay()", 1000);
            
            window.onload = function() {
                Epg.btn.init('btn_exercise', buttons, true);
                initPlay();
            }

            window.onUnload = function() {
                destory();
            }

            Epg.key.set({KEY_PLAY_PAUSE:"playOrStop()"});
            Epg.key.set({KEY_VOL_UP:"volUp()"});
            Epg.key.set({KEY_VOL_DOWN:"volDown()"});
            Epg.key.set({KEY_FAST_FORWARD:"fastForward()"});
            Epg.key.set({KEY_FAST_REWIND:"fastRewind()"});
            //Epg.Button.set({KEY_ENTER_TJ:"click()"});
            
            Epg.Button.defAction = function(){
            	var url = G(Epg.btn.current.id).title;
            	//G('ppp').innerText = playStat+'UUUU';
            	if(url==''||url==null){
                	if(playStat=='play'){
                        pause();
                		if(timer!=''){
                			clearTimeout(timer);
                		}
                		G('btn_current').src="__HD__/images/play/btn_current_stop_over.png";
                		buttons[1]['linkImage'] = '__HD__/images/play/btn_current_stop.png';
                		buttons[1]['focusImage'] = '__HD__/images/play/btn_current_stop_over.png';
                	}else{
                		resume();
                		if(timer!=''){
                			clearTimeout(timer);
                		}
                		timer = setTimeout("showMenu()", 3000);
                		G('btn_current').src="__HD__/images/play/btn_current_over.png";
                		buttons[1]['linkImage'] = '__HD__/images/play/btn_current.png';
                		buttons[1]['focusImage'] = '__HD__/images/play/btn_current_over.png';
                	}
            	}
            };
            
            function playOrStop(){
        		showMenu(true);
            	if(playStat=='play'){
                    pause();
            		if(timer!=''){
            			clearTimeout(timer);
            		}
                    Epg.Button.set('btn_current');
            		G('btn_current').src="__HD__/images/play/btn_current_stop_over.png";
            		buttons[1]['linkImage'] = '__HD__/images/play/btn_current_stop.png';
            		buttons[1]['focusImage'] = '__HD__/images/play/btn_current_stop_over.png';
            	}else{
            		resume();
            		if(timer!=''){
            			clearTimeout(timer);
            		}
            		timer = setTimeout("showMenu()", 3000);
            		G('btn_current').src="__HD__/images/play/btn_current_over.png";
            		buttons[1]['linkImage'] = '__HD__/images/play/btn_current.png';
            		buttons[1]['focusImage'] = '__HD__/images/play/btn_current_over.png';
            	}
            }

            //按键监控
            /**document.onkeypress = function(keyEvent) {
                keyEvent = keyEvent ? keyEvent : window.event;
                var keyval = keyEvent.which ? keyEvent.which : keyEvent.keyCode;
                if (keyval == 8 || keyval == -31) {  //返回
                    window.location = backUrl;
                }
                else if (keyval == 0x000D) {
                    mplay();
                }
                else if (keyval == 270) { //停止
                    pause();
                }
                else if (keyval == 260) { //音量-
                    volDown();
                }
                else if (keyval == 259) { //音量+
                    volUp();
                }
                else if (keyval == 264 || keyval == 39) { //快进
                    fastForward();
                }
                else if (keyval == 265 || keyval == 37) { //快退
                    fastRewind();
                }else if (keyval == 3864) { //播放暂停
                	if(playStat=='play'){
                        pause();
                	}else{
                		mplay();
                	}
                }
            }**/


        </script>    
    </head>
    <body onUnload="javascript:destory()" onLoad="javascript:initPlay()">
        <a id="a_back" style="display:none;" href="{:get_back_url('Index/recommend',1)}" ></a>
        <!-- 页面左侧 -->
        <div id="div_control">
            <!-- 上一集 -->
            <div id="div_btn_pre" title="{$playData['prevUrl']}" style="position:absolute;width:28px;height:31px;left:50px;top:25px;z-index: 1000;">
                <img id="btn_pre" src="__HD__/images/play/btn_pre.png" width="28" height="31">
            </div>
            <!-- 播放暂停 -->
            <div id="div_btn_current" style="position:absolute;width:48px;height:49px;left:138px;top:14px;">
                <img id="btn_current" src="__HD__/images/play/btn_current.png" width="48" height="49">
            </div>
            <!-- 下一集 -->
            <div id="div_btn_next" title="{$playData['nextUrl']}" style="position:absolute;width:28px;height:31px;left:254px;top:25px;">
                <img id="btn_next" src="__HD__/images/play/btn_next.png" width="31" height="28">
            </div>
        </div>
		<p id="ppp" style="top: 100px;left: 100px;width: 100px;height: 100px;">
        <!-- 页面上方 -->
        <div id="div_top">
            <!-- 练习-->
            <if condition="$section['libId'] eq ''">
                <div id="div_btn_exercise" style="position:absolute;width:138px;height:44px;left:142px;top:2px;">
                    <img id="btn_exercise" title="{:U('Library/detail?sectionId='.$section['id'].'&topicId='.$section['topicId'])}" src="__HD__/images/play/btn_exercise.png" width="138" height="44">
                </div>
            </if>
        </div>
    </body>
</html>